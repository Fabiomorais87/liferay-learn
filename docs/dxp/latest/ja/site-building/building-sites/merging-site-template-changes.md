# サイトテンプレートとサイト変更のマージ

サイトテンプレートから作成されたサイトに変更を加えると、サイトテンプレートとサイトはリンクされなくなります。 その時点からサイトテンプレートに加えられた変更は、サイトに **伝播されません** 。

## サイトテンプレートへのサイトの再リンク

リンクが解除された後に、サイトテンプレートからサイトに変更を伝搬する場合も、心配はありません。 サイトをサイトテンプレートに再リンクすることができます。 次の手順を実行します：

1. コントロールメニューに表示されるインフォメーションアイコン（![Information](../../images/icon-control-menu-information.png)）をクリックすると、インフォメーションダイアログが表示されます。
1. インフォメーションダイアログの ［**Reset Changes**］ リンクをクリックして、サイトテンプレートからの更新をマージします。

    ```{warning}
    変更をリセットすると、サイトとサイトテンプレートのリンクが解除されてから**ページに加えられた変更が元に戻ります**。 そのため、意図せずに変更が失われてしまうことがあります。 注意して続行してください。
    ```

複数のサイトページが変更されていて、それらのページにサイトテンプレートのページを再度適用したい場合は、各ページから ［**Reset Changes**］ ボタンを手動でクリックする必要があります。

![情報アイコンをクリックすると、サイトテンプレートに関する重要な情報が表示されます。](./merging-site-template-changes/images/01.png)

## サイトテンプレートからアプリの設定をマージする

サイトテンプレート管理者は、サイトテンプレートページのアプリの環境設定を行うことができます。 Liferay 管理者がサイトテンプレートからサイトを作成すると、アプリの環境設定はサイトテンプレートのアプリからコピーされ、デフォルトのアプリの環境設定はすべて上書きされます。 サイトテンプレートとサイトの変更を統合するとき（リセットするときなど）、アプリの環境設定はサイトテンプレートのアプリからサイトのアプリにコピーされます。 IDを参照していないグローバルアプリの環境設定またはローカルアプリの環境設定のみが上書きされます。

## サイトテンプレートからアプリデータをマージする

サイト管理者は、サイトテンプレートアプリケーションにデータを追加することもできます。 例えば、サイトテンプレート管理者は、サイトテンプレートページにWikiアプリを追加し、Wikiを使ってたくさんの記事を作成することができます。 Liferay管理者がサイトテンプレートからサイトを作成すると、データはサイトテンプレートのアプリからサイトのアプリにコピーされます。 本サイトのアプリの環境設定は、コピーされたデータのIDで更新されます。 例えば、複数のWiki記事を持ったWikiアプリを持つサイトテンプレートからサイトを作成した場合、Wiki記事はサイトテンプレートのスコープからサイトのスコープにコピーされ、サイトのWikiアプリはコピーされたWiki記事のIDで更新されます。

```{important}
アプリのデータ（掲示板のカテゴリなど）、フラグメントベースのページ、関連リソース、リソースの権限は、サイトがテンプレートに基づいて*最初*に作成された場合のみサイトテンプレートからサイトへのコピーされます。 これらのエンティティに加えられた変更は、本サイトが作成された後、本サイトに伝播されません。 また、このような変更は、*リセット*または*リセットとプロポゲーション*機能によってサイトに伝播されることはありません。
```

## サイトテンプレートマージの競合を解決する

サイトテンプレートとサイトの変更の結合に失敗することがあります。 例えば、そのフレンドリURLが衝突しているためにサイトテンプレートからのページを伝搬できない場合、Liferay DXPは何度か失敗した後にマージを停止します。 これを解決するには、以下の手順を実行してください。

1. 表示されたマージエラーに注意して、マージの競合を修正してください。
2. 競合を解消したら、プロダクトメニューを開き、サイトメニューの ［**設定**］ &rarr; ［**サイト設定**］ に移動します。
3. ［**リセットとプロポゲーション**］ ボタンをクリックすると、マージの失敗回数がリセットされ、サイトの変更を再度反映させようとします。

```{note}
この処理は、ページテンプレートのマージでも行うことができ、同様の手順で行います。
```

![図2：このタイプの警告は、サイトテンプレートページとフレンドリURLが競合している場合に表示されます。](./merging-site-template-changes/images/02.png)

## 関連情報

* [サイトテンプレートによるサイト構築](./building-sites-with-site-templates.md)
* [サイトテンプレートの共有](./sharing-site-templates.md)
* [サイト階層](./site-hierarchies.md)